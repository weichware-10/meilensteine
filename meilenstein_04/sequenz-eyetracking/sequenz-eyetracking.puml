@startuml {modul}
actor       Nutzer          as n
entity      System          as s    #DA70D5

box EyeTracking
participant EyeTrackingTutorial    as et
participant EyeTrackingSetup       as es
participant EyeTrackingBild        as eb
participant EyeTrackingAuge        as ea
end box

collections Config          as c
collections SpeicherMedium  as sm

== Vorbereitungen ==

activate n
activate s
activate es
es -> c : load Data
activate c
c --> es : Data
deactivate c
es -> eb : loadGrid() : int[2]
activate eb
eb -> s : erfrage screensize
s --> eb : screensize : int[2]
eb --> es : screensize : int[2]
deactivate eb
n -> s : schaut auf den bildschirm und wird von Kamera gesehen 
alt Müsste dauerhaft ausgeführt werden. Genaue Umsetzung noch Verhandelbar.
  es -> ea : startStream() : void
  activate ea
  ea -> s : erfrage Camstream
  s --> ea : Camstream (sendet dauerhaft)
  deactivate ea
end

== Tutorial ==
es -> s : erfragt Distanz
n -> s : Eingabe per Tastatur
s --> es : Distanz : float
loop Kalibrierung
  es -> et : tutorialPosition(punkt : int[2]): int[2]
  activate et
  et -> s : erfragt Mausdaten
  n -> s : Positionsbestätigung mit Maus
  s --> et : Kalibrierungsdaten
  et --> es : position: int[2]
  deactivate et
  alt Müsste dann nicht paralel laufen
    es -> ea : aktualisiereBild() : void
    activate ea
    ea -> s : erfrage Camstream
    s --> ea : Camstream (sendet dauerhaft)
    deactivate ea
  end
  es -> ea : getEye() : float[2]
  activate ea
  ea --> es : eye : float[2]
  deactivate ea
  es -> ea : getPupil() : float[2]
  activate ea
  ea --> es : Pupil : float[2]
  deactivate ea
end

== Versuch ==
loop Visual input
  alt Müsste dann nicht paralel laufen
    es -> ea : aktualisiereBild() : void
    activate ea
    ea -> s : erfrage Camstream
    s --> ea : Camstream (sendet dauerhaft)
    deactivate ea
  end
  es -> ea : getEye() : float[2]
  activate ea
  ea --> es : eye : float[2]
  deactivate ea
  es -> ea : getPupil() : float[2]
  activate ea
  ea --> es : Pupil : float[2]
  deactivate ea
end

== Abschluss ==
es -> sm: save Data
activate sm

@enduml
